window.__require=function t(e,o,s){function n(i,c){if(!o[i]){if(!e[i]){var a=i.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+i+"'")}}var h=o[i]={exports:{}};e[i][0].call(h.exports,function(t){return n(e[i][1][t]||t)},h,h.exports,t,e,o,s)}return o[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<s.length;i++)n(s[i]);return n}({block:[function(t,e,o){"use strict";cc._RF.push(e,"57ea3K3lQxN3qaRRK+DYTqE","block");var s=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function s(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(s.prototype=o.prototype,new s)}}(),n=this&&this.__decorate||function(t,e,o,s){var n,r=arguments.length,i=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,s);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(i=(r<3?n(i):r>3?n(e,o,i):n(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./game"),i=cc._decorator,c=i.ccclass,a=i.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.game=null,e.blockAtlas=null,e.idx=0,e.startPos=null,e.startBaseIdx=0,e.canMove=!0,e}return s(e,t),e.prototype.onLoad=function(){this.node.on("touchstart",this.touchStart,this),this.node.on("touchmove",this.touchMove,this),this.node.on("touchend",this.touchEnd,this)},e.prototype.onDisable=function(){this.node.off("touchstart",this.touchStart,this),this.node.off("touchmove",this.touchMove,this),this.node.off("touchend",this.touchEnd,this)},e.prototype.initBlock=function(t,e){this.idx=t,this.game=e,this.setImage(t),this.node.width=100+40*t},e.prototype.setImage=function(t){this.getComponent(cc.Sprite).spriteFrame=this.blockAtlas.getSpriteFrame(t+"")},e.prototype.touchStart=function(t){this.startPos=this.node.position,this.startBaseIdx=this.checkBlock(),this.game.canMove(this.startBaseIdx,this.idx)?this.canMove=!0:this.canMove=!1},e.prototype.touchMove=function(t){this.canMove&&(this.node.x+=t.getDeltaX(),this.node.y+=t.getDeltaY())},e.prototype.touchEnd=function(t){if(this.canMove){var e=this.checkBlock();if(void 0!==e&&this.startBaseIdx!==e)if(this.game.placeBlock({from:this.startBaseIdx,to:e},this.node))return;this.node.setPosition(this.startPos)}},e.prototype.checkBlock=function(){for(var t=0;t<this.game.bases.length;t++){var e=this.game.bases[t];if(cc.v2(this.node.x,0).sub(cc.v2(e.x,0)).mag()<e.width/2)return t}},n([a(r.default)],e.prototype,"game",void 0),n([a(cc.SpriteAtlas)],e.prototype,"blockAtlas",void 0),e=n([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./game":"game"}],game:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","game");var s=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function s(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(s.prototype=o.prototype,new s)}}(),n=this&&this.__decorate||function(t,e,o,s){var n,r=arguments.length,i=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,s);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(i=(r<3?n(i):r>3?n(e,o,i):n(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./block"),i=cc._decorator,c=i.ccclass,a=i.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.blockPrefab=null,e.bases=[],e.blockLayer=null,e.steps=0,e.level=1,e.maxLevel=4,e.levelBlockNumbers=0,e.baseBlockCount=2,e.blockNodes=[],e.basesStack=[[],[],[]],e}return s(e,t),e.prototype.onLoad=function(){this.init()},e.prototype.init=function(){this.steps=0,this.levelBlockNumbers=this.baseBlockCount+this.level,this.basesStack[2]=[];for(var t=0;t<this.levelBlockNumbers;t++){var e=null;(e=this.blockNodes[t])||(e=cc.instantiate(this.blockPrefab),this.blockLayer.addChild(e),this.blockNodes.push(e));var o=e.getComponent(r.default),s=this.levelBlockNumbers-t-1;e.x=this.bases[0].x,e.y=40*t-122,o.initBlock(s,this),this.basesStack[0].push(s)}},e.prototype.placeBlock=function(t,e){var o=t.from,s=t.to,n=this.bases[s],r=this.basesStack[s],i=this.basesStack[o],c=r.length;return console.log(this.basesStack),!(c&&r[c-1]<i[i.length-1])&&(e.x=n.x,e.y=40*c-122,r.push(i.pop()),this.steps++,!0)},e.prototype.canMove=function(t,e){var o=this.basesStack[t];return o[o.length-1]===e},e.prototype.checkSuccess=function(){return this.basesStack[2].length===this.levelBlockNumbers},e.prototype.levelUp=function(){this.level<this.maxLevel&&this.level++,this.init()},e.prototype.update=function(){this.title.string="Level: "+this.level+", Steps: "+this.steps,this.checkSuccess()&&this.levelUp()},n([a(cc.Label)],e.prototype,"title",void 0),n([a(cc.Prefab)],e.prototype,"blockPrefab",void 0),n([a(cc.Node)],e.prototype,"bases",void 0),n([a(cc.Node)],e.prototype,"blockLayer",void 0),e=n([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./block":"block"}]},{},["block","game"]);